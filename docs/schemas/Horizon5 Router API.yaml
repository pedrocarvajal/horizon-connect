openapi: 3.0.3
info:
  title: Horizon5 Router API
  version: 0.1.*
  description: API for Horizon5 Router
  contact:
    name: Pedro Carvajal
    email: hello@horizon5.tech
  license:
    name: PolyForm Noncommercial 1.0.0
paths:
  /api/backtest/:
    post:
      operationId: backtest_create
      description: Creates a new backtest record in the database.
      summary: Create a backtest
      tags:
      - Backtest
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BacktestRequest'
        required: true
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestResponse'
          description: ''
  /api/backtest/{id}/:
    put:
      operationId: backtest_update
      description: Updates an existing backtest record in the database. All fields
        are optional - only include the fields you want to update.
      summary: Update a backtest
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: Backtest ID
        required: true
      tags:
      - Backtest
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BacktestUpdateRequest'
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestUpdateResponse'
          description: ''
    delete:
      operationId: backtest_destroy
      description: Deletes an existing backtest record from the database. This operation
        cannot be undone.
      summary: Delete a backtest
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: Backtest ID
        required: true
      tags:
      - Backtest
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestDeleteResponse'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestNotFoundResponse'
          description: ''
  /api/backtests/:
    get:
      operationId: backtests_retrieve
      description: Provides a list of backtests saved on the database, and also allows
        to filter the results by various parameters.
      summary: Get backtests
      parameters:
      - in: query
        name: filter_by
        schema:
          type: string
        description: 'Filter by field (format: column:value)'
      - in: query
        name: page
        schema:
          type: integer
          default: 1
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
          default: 10
        description: Number of items per page
      - in: query
        name: sort
        schema:
          type: string
          default: created_at
        description: Field to sort by
      - in: query
        name: sort_order
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
        description: Sort order (asc or desc)
      tags:
      - Backtest
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestControllerResponse'
          description: ''
  /api/order/:
    post:
      operationId: order_create
      description: Creates a new order record in the database.
      summary: Create an order
      tags:
      - Order
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderRequest'
        required: true
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderResponse'
          description: ''
  /api/order/{id}/:
    put:
      operationId: order_update
      description: Updates an existing order record in the database. All fields are
        optional - only include the fields you want to update.
      summary: Update an order
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: Order ID
        required: true
      tags:
      - Order
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderUpdateRequest'
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderUpdateResponse'
          description: ''
    delete:
      operationId: order_destroy
      description: Deletes an existing order record from the database. This operation
        cannot be undone.
      summary: Delete an order
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: Order ID
        required: true
      tags:
      - Order
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderDeleteResponse'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderNotFoundResponse'
          description: ''
  /api/orders/:
    get:
      operationId: orders_retrieve
      description: Provides a list of orders saved on the database, and also allows
        to filter the results by various parameters.
      summary: Get orders
      parameters:
      - in: query
        name: filter_by
        schema:
          type: string
        description: 'Filter by field (format: column:value)'
      - in: query
        name: page
        schema:
          type: integer
          default: 1
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
          default: 10
        description: Number of items per page
      - in: query
        name: sort
        schema:
          type: string
          default: created_at
        description: Field to sort by
      - in: query
        name: sort_order
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
        description: Sort order (asc or desc)
      tags:
      - Order
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderControllerResponse'
          description: ''
  /api/reports/:
    get:
      operationId: reports_retrieve
      description: Provides a list of reports saved on the database, and also allows
        to filter the results by various parameters.
      summary: Get reports
      parameters:
      - in: query
        name: filter_by
        schema:
          type: string
        description: 'Filter by field (format: column:value)'
      - in: query
        name: page
        schema:
          type: integer
          default: 1
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
          default: 10
        description: Number of items per page
      - in: query
        name: sort
        schema:
          type: string
          default: created_at
        description: Field to sort by
      - in: query
        name: sort_order
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
        description: Sort order (asc or desc)
      tags:
      - Report
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportControllerResponse'
          description: ''
  /api/snapshot/:
    post:
      operationId: snapshot_create
      description: Creates a new snapshot record in the database.
      summary: Create a snapshot
      tags:
      - Snapshot
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SnapshotRequest'
        required: true
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SnapshotResponse'
          description: ''
  /api/snapshot/{id}/:
    delete:
      operationId: snapshot_destroy
      description: Deletes an existing snapshot record from the database. This operation
        cannot be undone.
      summary: Delete a snapshot
      parameters:
      - in: path
        name: id
        schema:
          type: string
        description: Snapshot ID
        required: true
      tags:
      - Snapshot
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SnapshotDeleteResponse'
          description: ''
        '404':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SnapshotNotFoundResponse'
          description: ''
  /api/snapshots/:
    get:
      operationId: snapshots_retrieve
      description: Provides a list of snapshots saved on the database, and also allows
        to filter the results by various parameters.
      summary: Get snapshots
      parameters:
      - in: query
        name: filter_by
        schema:
          type: string
        description: 'Filter by field (format: column:value)'
      - in: query
        name: page
        schema:
          type: integer
          default: 1
        description: Page number
      - in: query
        name: page_size
        schema:
          type: integer
          default: 10
        description: Number of items per page
      - in: query
        name: sort
        schema:
          type: string
          default: created_at
        description: Field to sort by
      - in: query
        name: sort_order
        schema:
          type: string
          enum:
          - asc
          - desc
          default: desc
        description: Sort order (asc or desc)
      tags:
      - Snapshot
      security:
      - ApiKeyAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SnapshotControllerResponse'
          description: ''
components:
  schemas:
    BacktestControllerResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Backtests'
        success:
          type: boolean
        message:
          type: string
      required:
      - data
      - success
    BacktestData:
      type: object
      properties:
        success:
          type: boolean
      required:
      - success
    BacktestDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    BacktestNotFoundResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    BacktestRequest:
      type: object
      properties:
        asset:
          type: string
        strategies:
          type: string
        from_date:
          type: integer
        to_date:
          type: integer
      required:
      - asset
      - from_date
      - strategies
      - to_date
    BacktestResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          $ref: '#/components/schemas/BacktestData'
      required:
      - data
      - message
      - success
    BacktestUpdateRequest:
      type: object
      properties:
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          default: '{running}'
    BacktestUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
      required:
      - success
    Backtests:
      type: object
      properties:
        success:
          type: boolean
      required:
      - success
    OrderControllerResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Orders'
        success:
          type: boolean
        message:
          type: string
      required:
      - data
      - success
    OrderData:
      type: object
      properties:
        _id:
          type: string
          title: ' id'
      required:
      - _id
    OrderDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    OrderNotFoundResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    OrderRequest:
      type: object
      properties:
        backtest:
          type: boolean
        backtest_id:
          type: string
          nullable: true
        strategy_id:
          type: string
        symbol:
          type: string
        gateway:
          type: string
        side:
          type: string
        order_type:
          type: string
        status:
          type: string
        volume:
          type: number
          format: double
        executed_volume:
          type: number
          format: double
        price:
          type: number
          format: double
        close_price:
          type: number
          format: double
          nullable: true
        take_profit_price:
          type: number
          format: double
          nullable: true
        stop_loss_price:
          type: number
          format: double
          nullable: true
        client_order_id:
          type: string
          nullable: true
        filled:
          type: boolean
        profit:
          type: number
          format: double
          nullable: true
        profit_percentage:
          type: number
          format: double
          nullable: true
        created_at:
          type: integer
        updated_at:
          type: integer
      required:
      - backtest
      - created_at
      - executed_volume
      - filled
      - gateway
      - order_type
      - price
      - side
      - status
      - strategy_id
      - symbol
      - updated_at
      - volume
    OrderResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          $ref: '#/components/schemas/OrderData'
      required:
      - data
      - message
      - success
    OrderUpdateRequest:
      type: object
      properties:
        backtest:
          type: boolean
        strategy_id:
          type: string
        symbol:
          type: string
        gateway:
          type: string
        side:
          type: string
        order_type:
          type: string
        status:
          type: string
        volume:
          type: number
          format: double
        executed_volume:
          type: number
          format: double
        price:
          type: number
          format: double
        filled:
          type: boolean
        created_at:
          type: integer
        updated_at:
          type: integer
        backtest_id:
          type: string
        close_price:
          type: number
          format: double
        take_profit_price:
          type: number
          format: double
        stop_loss_price:
          type: number
          format: double
        client_order_id:
          type: string
        profit:
          type: number
          format: double
        profit_percentage:
          type: number
          format: double
    OrderUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    Orders:
      type: object
      properties:
        id:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
      - created_at
      - id
      - updated_at
    ReportControllerResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Reports'
        success:
          type: boolean
        message:
          type: string
      required:
      - data
      - success
    Reports:
      type: object
      properties:
        id:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
      - created_at
      - id
      - updated_at
    SnapshotControllerResponse:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Snapshots'
        success:
          type: boolean
        message:
          type: string
      required:
      - data
      - success
    SnapshotData:
      type: object
      properties:
        _id:
          type: string
          title: ' id'
      required:
      - _id
    SnapshotDeleteResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    SnapshotNotFoundResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
      required:
      - message
      - success
    SnapshotRequest:
      type: object
      properties:
        backtest:
          type: boolean
        backtest_id:
          type: string
        strategy_id:
          type: string
        event:
          type: string
        nav:
          type: number
          format: double
        allocation:
          type: number
          format: double
        nav_peak:
          type: number
          format: double
        r2:
          type: number
          format: double
        cagr:
          type: number
          format: double
        calmar_ratio:
          type: number
          format: double
        expected_shortfall:
          type: number
          format: double
        max_drawdown:
          type: number
          format: double
        profit_factor:
          type: number
          format: double
        recovery_factor:
          type: number
          format: double
        sharpe_ratio:
          type: number
          format: double
        sortino_ratio:
          type: number
          format: double
        ulcer_index:
          type: number
          format: double
        created_at:
          type: integer
      required:
      - backtest
      - backtest_id
      - strategy_id
    SnapshotResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        data:
          $ref: '#/components/schemas/SnapshotData'
      required:
      - data
      - message
      - success
    Snapshots:
      type: object
      properties:
        id:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
      - created_at
      - id
      - updated_at
    StatusEnum:
      enum:
      - pending
      - running
      - completed
      - failed
      type: string
      description: |-
        * `pending` - pending
        * `running` - running
        * `completed` - completed
        * `failed` - failed
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
externalDocs:
  description: GitHub Repository
  url: https://github.com/horizon5-tech
